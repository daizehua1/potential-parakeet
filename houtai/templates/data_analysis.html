<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <!-- 引入 jquery.js-->
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script src="/static/verify/js/jquery-1.11.0.min.js"></script>
     <script src="/static/js/westeros.js"></script>
    <!-- 引入 echarts.js -->
    {% load static %}
    <script src="/static/verify/js/echarts.min.js"></script>
    <style>
        .fee{
            width: 800px;
            height:300px;
            padding-left: 12%;
        }
        .container{
            background-color: white;
            display: inline-block;
            box-shadow:0px 0px 10px 5px #E4E4E4;
            padding-left: 0.5%;
            padding-top: 4%;
            padding-bottom:0.5%;
            width: 99%;
        }
        .fluency{
            width: 800px;
            height: 300px;
            padding-left: 12%;
            padding-top: 10%;
        }

    </style>
</head>
<body style="background-color: #f1f1f1">
    <div class="container">
    <div class="fee" id="fee" ></div>
    <div class="fluency" id="fluency"></div>
    <div style="display: inline-flex;margin-left: 8%;padding-top: 5%">
    <div id="place" style="width: 400px;height:400px;"></div>
    <div id="type" style="width: 600px;height:400px;"></div></div>
    </div>
    <script type="text/javascript">
    $(function () {
        var server_info;
        var myChart = echarts.init(document.getElementById('fee'));
        var option = {
            backgroundColor: 'white',
            title: {
                text: '2019-2022 年度收入',

                textStyle:{
                    fontStyle : 'italic',
                    fontsize:20,
                    color:'black',
                },


            },
            tooltip: {
                show:true,
            },
            legend: {
                data:['充电费','停车费','总收入'],
                left:'right',
            },
            xAxis: {
                    name:'日期',
                    data:['2012','2013','2014','2015','2016','2017','2018','2019','2020','2021','2022'],
                    axisLine: {

                        lineStyle: {
                            type: 'dashed'

                        }
                    }
            },

            yAxis: {
                type:'value',
                name:'收入'
            },
            dataZoom: [
                    {
                type: 'inside',
                start: 0,
                end: 30
             },
            {
                start: 0,
                end: 30
            }
  ],

            series: [
              {
                data: {{ parking_fee | safe }},
                name:'停车费',
                type:'line',
                stack :'x',
                areaStyle:{color:'red'},
                lineStyle:{color:'red'}
            },
              {
                data: {{ charging_fee | safe }},
                type:'line',
                stack :'x',
                areaStyle:{},
                name:'充电费',
            },
                {
                data: {{ total_fee | safe }},
                type:'line',
                stack :'x',
                areaStyle:{},
                name:'总收入',
            },
            ]
        };
        myChart.setOption(option, true);

        setInterval( function () {

                $.ajax({
                    type: 'GET',
                    url: '/renew_api/',
                    dataType: 'json',
                    success: function (arg) {

                        server_info = eval(arg);
                        console.log(server_info.parking_fee)
                        option.series[0].data = server_info.parking_fee;
                        option.series[1].data = server_info.charging_fee;
                        option.series[2].data = server_info.total_fee;
                    }
                });
                    myChart.setOption(option, true);
                }, 6000);
         window.onresize = function () {
            myChart.resize();
        };
    });

    //车流量分析
    var mCharts1 = echarts.init(document.getElementById("fluency"))
    var xDataArr = ['00:00-01:00','01:00-02:00','02:00-03:00','03:00-04:00','04:00-05:00','05:00-06:00','06:00-07:00','07:00-08:00','8:00-9:00', '9:00-10:00', '10:00-11:00', '11:00-12:00', '12:00-13:00', '13:00-14:00', '14:00-15:00', '15:00-16:00', '16:00-17:00', '17:00-18:00', '18:00-19:00', '19:00-20:00','20:00-21:00','21:00-22:00','22:00-23:00','23:00-24:00']
   var yDataArr = [1,2,6,1,3,50,100,300, 280, 900, 100, 800, 700, 1400, 130, 900, 1000, 800, 600,400,150,200,100,200]
    var option = {
        title: {
                text: '昨日车流量统计',

                textStyle: {
                    fontStyle: 'italic',
                    fontsize: 10
                }
                },
         tooltip: {},
        xAxis:{
            name:'时间',
            type:'category',
            data:xDataArr
        },
        yAxis:{
            name:'车辆数目/辆',
            type:'value'
        },
        dataZoom: [
                    {
                type: 'inside',
                start: 0,
                end: 30
             },
            {
                start: 0,
                end: 30
            }
  ],
        color:['blue'],
        legend: {
                data:['车辆数目'],
                left:'right',


            },
        series:[
            {   name:'车辆数目',
                type:'line',
                data:yDataArr,
                lineStyle: {
                color:'blue',
                },
                markPoint:{
                symbolSize:60,
                    itemStyle:{
                    normal:{
                        color: "blue",
                        label:{
                            show:true,
                            color:"white"
                        }
                    }

                    },
                data:[
                        {type:'max',name:'最大值'},
                        {type:'min',name:'最小值'}
                           ],

                       },
                markLine:{
                data:[
                    {type:'average',name:'平均值'}
                           ],
                                    itemStyle:{
                    normal:{
                        color: "blue",
                        label:{
                            show:true,

                        }
                    }

                    },
                       }

            },

        ]
    }
    mCharts1.setOption(option)
{#    //车辆归属地分析#}
{#    var myChart1 = echarts.init(document.getElementById('place'));#}
{#            var pieData = [#}
{#            {#}
{#                name: '山西',#}
{#                value: '1100'#}
{#            },#}
{#            {#}
{#                name: '山东',#}
{#                value: '2800'#}
{#            },#}
{#            {#}
{#                name: '北京',#}
{#                value: '4500'#}
{#            },#}
{#            {#}
{#                name: '上海',#}
{#                value: '2202'#}
{#            },#}
{#            {#}
{#                name: '青海',#}
{#                value: '2421'#}
{#            },#}
{#            {#}
{#                name: '其他',#}
{#                value: '800'#}
{#            }#}
{##}
{#        ]#}
{#option  = {#}
{#  backgroundColor: 'white',#}
{#  title: {#}
{#    text: '车辆归属地分析',#}
{#    left: 'center',#}
{#    top: 20,#}
{#    textStyle: {#}
{#      color: 'black'#}
{#    }#}
{#  },#}
{#  tooltip: {#}
{#    trigger: 'item'#}
{#  },#}
{#  visualMap: {#}
{#    show: false,#}
{#    min: 80,#}
{#    max: 600,#}
{#    inRange: {#}
{#      colorLightness: [0, 1]#}
{#    }#}
{#  },#}
{#  series: [#}
{#    {#}
{#      name: '车辆数量',#}
{#      type: 'pie',#}
{#      radius: '55%',#}
{#      center: ['50%', '50%'],#}
{#      data: pieData.sort(function (a, b) {#}
{#        return a.value - b.value;#}
{#      }),#}
{#      roseType: 'radius',#}
{#      label: {#}
{#        color: 'black'#}
{#      },#}
{#      labelLine: {#}
{#        lineStyle: {#}
{#          color: 'black'#}
{#        },#}
{#        smooth: 0.2,#}
{#        length: 10,#}
{#        length2: 20#}
{#      },#}
{#      itemStyle: {#}
        {#color: 'blue',#}
{#        shadowBlur: 200,#}
{#        shadowColor: 'rgba(0, 0, 0, 0.5)'#}
{#      },#}
{#      animationType: 'scale',#}
{#      animationEasing: 'elasticOut',#}
{#      animationDelay: function (idx) {#}
{#        return Math.random() * 200;#}
{#      }#}
{#    }#}
{#  ]#}
{#};#}
{#        myChart1.setOption(option)#}
{##}
{##}
{#    //车辆类型分析#}
{#    var myChart2 = echarts.init(document.getElementById('type'));#}
{#    option = {#}
{#  tooltip: {#}
{#    trigger: 'item'#}
{#  },#}
{#  legend: {#}
{#    top: '5%',#}
{#    left: 'center',#}
{#    // doesn't perfectly work with our tricks, disable it#}
{#    selectedMode: false#}
{#  },#}
{#  series: [#}
{#    {#}
{#      name: '车辆数量',#}
{#      type: 'pie',#}
{#      radius: ['40%', '70%'],#}
{#      center: ['50%', '70%'],#}
{#      // adjust the start angle#}
{#      startAngle: 180,#}
{#      label: {#}
{#        show: true,#}
{#        formatter(param) {#}
{#          // correct the percentage#}
{#          return param.name + ' (' + param.percent * 2 + '%)';#}
{#        }#}
{#      },#}
{#      data: [#}
{#        { value: 1048, name: '普通汽车' },#}
{#        { value: 735, name: '新能源车' },#}
{#        { value: 580, name: '大型车辆' },#}
{#        { value: 484, name: '军事车辆' },#}
{##}
{#        {#}
{#          // make an record to fill the bottom 50%#}
{#          value: 1048 + 735 + 580 + 484 + 300,#}
{#          itemStyle: {#}
{#            // stop the chart from rendering this piece#}
{#            color: 'none',#}
{#            decal: {#}
{#              symbol: 'none'#}
{#            }#}
{#          },#}
{#          label: {#}
{#            show: false#}
{#          }#}
{#        }#}
{#      ]#}
{#    }#}
{#  ]#}
{#};#}
{#    myChart2.setOption(option)#}
    </script>
</body>
</html>


(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/reservation/reservation"],{265:function(e,n,t){"use strict";(function(e,n){var o=t(4);t(26);o(t(25));var r=o(t(266));e.__webpack_require_UNI_MP_PLUGIN__=t,n(r.default)}).call(this,t(1)["default"],t(2)["createPage"])},266:function(e,n,t){"use strict";t.r(n);var o=t(267),r=t(269);for(var a in r)["default"].indexOf(a)<0&&function(e){t.d(n,e,(function(){return r[e]}))}(a);t(272);var u,s=t(32),i=Object(s["default"])(r["default"],o["render"],o["staticRenderFns"],!1,null,null,null,!1,o["components"],u);i.options.__file="pages/reservation/reservation.vue",n["default"]=i.exports},267:function(e,n,t){"use strict";t.r(n);var o=t(268);t.d(n,"render",(function(){return o["render"]})),t.d(n,"staticRenderFns",(function(){return o["staticRenderFns"]})),t.d(n,"recyclableRender",(function(){return o["recyclableRender"]})),t.d(n,"components",(function(){return o["components"]}))},268:function(e,n,t){"use strict";var o;t.r(n),t.d(n,"render",(function(){return r})),t.d(n,"staticRenderFns",(function(){return u})),t.d(n,"recyclableRender",(function(){return a})),t.d(n,"components",(function(){return o}));try{o={uniNoticeBar:function(){return t.e("uni_modules/uni-notice-bar/components/uni-notice-bar/uni-notice-bar").then(t.bind(null,355))},uniPopup:function(){return t.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(t.bind(null,348))},uniForms:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uni-forms/components/uni-forms/uni-forms")]).then(t.bind(null,306))},uniFormsItem:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uni-forms/components/uni-forms-item/uni-forms-item")]).then(t.bind(null,322))},uniDataSelect:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uni-data-select/components/uni-data-select/uni-data-select")]).then(t.bind(null,329))},carNumberInput:function(){return t.e("uni_modules/car-number-input/components/car-number-input/car-number-input").then(t.bind(null,362))},uniFab:function(){return t.e("uni_modules/uni-fab/components/uni-fab/uni-fab").then(t.bind(null,341))}}}catch(s){if(-1===s.message.indexOf("Cannot find module")||-1===s.message.indexOf(".vue"))throw s;console.error(s.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var r=function(){var e=this,n=e.$createElement;e._self._c},a=!1,u=[];r._withStripped=!0},269:function(e,n,t){"use strict";t.r(n);var o=t(270),r=t.n(o);for(var a in o)["default"].indexOf(a)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(a);n["default"]=r.a},270:function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;t(271);var o={data:function(){return{pattern:{color:"gray",backgroundColor:"#FFFFFF",selectedColor:"#007AFF",buttonColor:"orange"},content:[{iconPath:"/static/images/fab/map.png",selectedIconPath:"/static/images/fab/map(1).png",text:"地图",active:!0},{iconPath:"/static/images/fab/rule.png",selectedIconPath:"/static/images/fab/rule(1).png",text:"规则",active:!0}],formData:{level:"",number:"",plate_number:"",length:0},address:"",rules:{level:{rules:[{required:!0,errorMessage:"请选择停车层"}]}},range1:[],range2:[],range3:[{value:0,text:"无"}],range_data:{}}},methods:{data_process:function(e,n){for(var t=0;t<n;t++){var o={value:t,text:e.data[t].level};this.range1.push(o)}},numberInputResult:function(e){this.formData.plate_number=e},trigger:function(n){console.log(n),1==n.index?e.showModal({title:"提示",content:"①负责对停车场(库)的汽车，摩托车，以及自行车管理。\n\n                                    ②实行 24 小时轮流值班，服从统一安排调度。\n\n                                   ③按规定着装，佩戴工作牌，对出入车辆按规定和程序指挥放行， 并认真填写《车辆出入登记表》。\n\n                                   ④遵守规章制度，按时上下班，认真做好交接班手续，不擅离职守。\n\n                                   ⑤负责指挥区内车辆行驶和停放，维持广场交通、停车秩序。\n\n                                   ⑥负责对广场道路和停车场的停放车辆进行巡视查看，保证车辆安全。",success:function(e){e.confirm?console.log("用户点击确定"):e.cancel&&console.log("用户点击取消")}}):this.$refs.popup.open("top")},callphone:function(n){e.makePhoneCall({phoneNumber:n})},navi:function(){e.navigateTo({url:"/pages/parking-map/parking-map"})},otherFun:function(e){e&&(console.log(e),this.address=e)},change:function(n){var t=this,o=this.range1[n].text;this.formData.level=o,e.request({url:"http://localhost:3000/prereservation",data:{level:o},method:"POST",header:{"Content-Type":"application/json"},success:function(e){t.range2=e.data,t.range2.forEach((function(e,n){e["value"]=n})),t.range3=t.range2.map((function(e){return{value:e.value,text:e.number}}))}})},change1:function(e){this.formData.number=this.range3[e].text},submit:function(){var n=this;this.length=this.formData.plate_number.length,e.getStorageSync("islogining")?(this.formData.plate_number=this.formData.plate_number.trim(),1==e.getStorageSync("reservation_status")&&console.log("不可以预约"),1!=e.getStorageSync("reservation_status")&&null!=this.formData.plate_number&&null!=this.formData.level?this.$refs.form.validate().then((function(t){n.formData.plate_number=t.plate_number,n.formData.number=n.range3[t.number].text,n.formData.level=n.range1[t.level].text,e.request({url:"http://localhost:3000/reservation",data:{level:n.formData.level,number:n.formData.number,userphone:e.getStorageSync("userphone"),plate_number:n.formData.plate_number,address:e.getStorageSync("address")},method:"POST",header:{"Content-Type":"application/json"},success:function(e){console.log(e)}}),e.setStorageSync("reservation_status",1),e.showToast({title:"预约成功",duration:2e3})})):(console.log("预约失败",e.getStorageSync("reservation_status")),e.showToast({title:"预约失败",duration:2e3,icon:"none"}))):e.navigateTo({url:"/pages/login/login"})}},onLoad:function(){var n=this;this.address=e.getStorageSync("address"),e.request({url:"http://localhost:3000/check_reservation",data:{userphone:e.getStorageSync("userphone")},method:"POST",header:{"Content-Type":"application/json"},success:function(n){console.log(n.data[0].number,"判断是否可以预约0为可以预约"),n.data>=1?e.setStorageSync("reservation_status",1):e.setStorageSync("reservation_status",0)}}),e.request({url:"http://localhost:3000/check_parking_number",method:"POST",header:{"Content-Type":"application/json"},success:function(e){n.data_process(e,e.data.length)}})}};n.default=o}).call(this,t(2)["default"])},272:function(e,n,t){"use strict";t.r(n);var o=t(273),r=t.n(o);for(var a in o)["default"].indexOf(a)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(a);n["default"]=r.a},273:function(e,n,t){}},[[265,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/reservation/reservation.js.map